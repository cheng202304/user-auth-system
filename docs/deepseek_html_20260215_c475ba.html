<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=yes">
  <title>å¿˜è®°å¯†ç  Â· éªŒè¯6ä½è´¦å·</title>
  <style>
    /* RESET & åŸºç¡€å˜é‡ â€”â€” å®Œå…¨å¤ç”¨ç™»å½•/æ³¨å†Œæ ·å¼ï¼Œä»…å¾®è°ƒ */
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', sans-serif;
    }

    body {
      background: linear-gradient(145deg, #f4f0fa 0%, #e9e3f8 100%);
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 1rem;
    }

    /* å¡ç‰‡å®¹å™¨ â€”â€” å®Œå…¨è‡ªé€‚åº”ï¼Œæœ€å¤§å®½åº¦èˆ’é€‚ */
    .forgot-card {
      background: rgba(255, 255, 255, 0.9);
      backdrop-filter: blur(8px);
      -webkit-backdrop-filter: blur(8px);
      border-radius: 2rem;
      box-shadow: 0 25px 45px -12px rgba(80, 50, 120, 0.25), 0 2px 8px rgba(0,0,0,0.05);
      padding: 2.2rem 1.8rem;
      width: 100%;
      max-width: 440px;
      border: 1px solid rgba(255,255,255,0.5);
      transition: all 0.2s ease;
    }

    /* æ ‡é¢˜ */
    .forgot-card h2 {
      font-size: clamp(1.8rem, 6vw, 2.3rem);
      font-weight: 600;
      letter-spacing: -0.02em;
      margin-bottom: 0.2rem;
      color: #1a2e3f;
      display: flex;
      align-items: center;
      gap: 0.5rem;
      flex-wrap: wrap;
    }
    .forgot-card h2 span {
      background: #8a5c9c;
      color: white;
      font-size: 0.8rem;
      padding: 0.2rem 0.8rem;
      border-radius: 30px;
      font-weight: 400;
      letter-spacing: 0.3px;
    }

    /* ç®€çŸ­æç¤º */
    .input-hint {
      color: #4d6272;
      margin-bottom: 1.8rem;
      font-size: 0.95rem;
      border-left: 3px solid #9b7cb0;
      padding-left: 0.75rem;
      background: rgba(138, 92, 156, 0.05);
      border-radius: 0 4px 4px 0;
    }

    /* è¾“å…¥æ¡†ç»„ */
    .input-group {
      margin-bottom: 1.6rem;
      display: flex;
      flex-direction: column;
      gap: 0.3rem;
    }

    .input-group label {
      font-size: 0.9rem;
      font-weight: 600;
      color: #1e3b5c;
      letter-spacing: 0.3px;
      margin-left: 0.3rem;
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }
    .input-group label i {
      font-style: normal;
      color: #8a5c9c;
      font-weight: 400;
      background: #efe5f5;
      padding: 0.15rem 0.6rem;
      border-radius: 20px;
      font-size: 0.75rem;
    }

    /* ç»Ÿä¸€è¾“å…¥æ¡†æ ·å¼ */
    .input-field {
      width: 100%;
      padding: 1rem 1.2rem;
      font-size: 1.1rem;
      border: 2px solid #dbe4eb;
      background: white;
      border-radius: 60px;
      outline: none;
      transition: border 0.15s, box-shadow 0.2s;
      letter-spacing: 1px;
      font-family: 'SF Mono', 'Fira Code', 'Courier New', monospace;
    }

    .input-field:focus {
      border-color: #8a5c9c;
      box-shadow: 0 0 0 4px rgba(138, 92, 156, 0.15);
    }

    .input-field.error-shake {
      animation: shake 0.3s ease-in-out;
      border-color: #c84a4a !important;
      background-color: #fff7f7;
    }

    @keyframes shake {
      0%,100% { transform: translateX(0); }
      20% { transform: translateX(-8px); }
      40% { transform: translateX(8px); }
      60% { transform: translateX(-4px); }
      80% { transform: translateX(4px); }
    }

    /* é”™è¯¯ä¿¡æ¯åŒºåŸŸï¼ˆå³å¯¹é½ï¼‰ */
    .field-foot {
      display: flex;
      justify-content: flex-end;
      margin: 0.3rem 0.8rem 0 0.8rem;
      font-size: 0.75rem;
      min-height: 1.2rem;
    }
    .field-foot .error-message {
      color: #c84a4a;
      font-weight: 500;
      visibility: hidden;
      opacity: 0;
      transition: 0.1s;
    }
    .field-foot .error-message.show {
      visibility: visible;
      opacity: 1;
    }

    /* éªŒè¯é€šè¿‡åå‡ºç°çš„æ–°å¯†ç åŒºåŸŸï¼ˆåˆå§‹éšè—ï¼‰ */
    .new-password-section {
      margin-top: 0.5rem;
      margin-bottom: 1rem;
      padding-top: 0.5rem;
      border-top: 1px dashed #c0b1cc;
    }

    /* æŒ‰é’®ç»„ â€”â€” éªŒè¯ç»¿åº•ï¼Œå–æ¶ˆè“åº•ï¼Œé‡ç½®ç´«åº•ï¼ˆå¤šçŠ¶æ€ï¼‰ */
    .button-row {
      display: flex;
      gap: 1rem;
      margin: 2rem 0 1.8rem;
      flex-wrap: wrap;
    }
    .btn {
      flex: 1 1 0px;
      min-width: 120px;
      padding: 0.9rem 0.5rem;
      font-size: 1.1rem;
      font-weight: 600;
      border-radius: 60px;
      border: none;
      box-shadow: 0 4px 10px rgba(0, 20, 30, 0.1);
      cursor: pointer;
      transition: 0.15s;
      letter-spacing: 0.5px;
      border: 2px solid transparent;
    }
    /* éªŒè¯æŒ‰é’® - ç»¿åº• (åŸç™»å½•ç»¿) */
    .btn-verify {
      background: #2a7a4b;
      color: white;
      box-shadow: 0 8px 18px -6px rgba(42, 122, 75, 0.5);
    }
    .btn-verify:hover {
      background: #1e5f39;
      transform: scale(1.02);
    }
    /* å–æ¶ˆæŒ‰é’® - è“åº• (åŸå–æ¶ˆè“) */
    .btn-cancel {
      background: #1e6f9f;
      color: white;
      box-shadow: 0 8px 18px -6px rgba(30, 111, 159, 0.5);
    }
    .btn-cancel:hover {
      background: #145a84;
      transform: scale(1.02);
    }
    /* é‡ç½®å¯†ç æŒ‰é’® - ç´«è‰² (æ–°å¢) */
    .btn-reset {
      background: #8a5c9c;
      color: white;
      box-shadow: 0 8px 18px -6px rgba(138, 92, 156, 0.5);
    }
    .btn-reset:hover {
      background: #6f4b7e;
      transform: scale(1.02);
    }

    /* åº•éƒ¨é“¾æ¥è¡Œï¼šè¿”å›ç™»å½• */
    .footer-links {
      display: flex;
      justify-content: center;
      align-items: center;
      font-size: 0.9rem;
      padding: 0 0.2rem;
      color: #3c5a7d;
    }
    .footer-links a {
      text-decoration: none;
      font-weight: 500;
      transition: 0.1s;
      padding: 0.4rem 0.8rem;
      color: #8a5c9c;
    }
    .footer-links a:hover {
      text-decoration: underline;
      opacity: 0.8;
    }

    /* éå¸¸å°çš„å±å¹• (<=360px) å¾®è°ƒ */
    @media (max-width: 380px) {
      .forgot-card { padding: 1.5rem 1rem; }
      .button-row { flex-direction: column; }
      .btn { min-width: 100%; }
    }
  </style>
</head>
<body>
  <div class="forgot-card">
    <h2>
      å¿˜è®°å¯†ç 
      <span>éªŒè¯è´¦å·</span>
    </h2>
    <div class="input-hint">è¾“å…¥6ä½è´¦å·éªŒè¯èº«ä»½ï¼Œç„¶åè®¾ç½®æ–°å¯†ç </div>

    <!-- è´¦å·è¾“å…¥åŒº (ç”¨äºéªŒè¯èº«ä»½) -->
    <div class="input-group">
      <label>
        ğŸ” è´¦å·
        <i>6ä½æ•°å­—</i>
      </label>
      <input type="text" id="accountInput" class="input-field" placeholder="è¾“å…¥å·²æ³¨å†Œçš„6ä½è´¦å·" maxlength="6" inputmode="numeric" pattern="\d*">
      <div class="field-foot">
        <span class="error-message" id="accountError">éœ€6ä½æ•°å­—</span>
      </div>
    </div>

    <!-- éªŒè¯é€šè¿‡åå‡ºç°çš„æ–°å¯†ç åŒºåŸŸ (åˆå§‹éšè—) -->
    <div id="newPasswordSection" style="display: none;">
      <div class="input-group">
        <label>
          âœ¨ æ–°å¯†ç 
          <i>6ä½æ•°å­—</i>
        </label>
        <input type="password" id="newPasswordInput" class="input-field" placeholder="è®¾ç½®6ä½æ–°å¯†ç " maxlength="6" inputmode="numeric" pattern="\d*">
        <div class="field-foot">
          <span class="error-message" id="newPasswordError">éœ€6ä½æ•°å­—</span>
        </div>
      </div>
      
      <div class="input-group">
        <label>
          âœ… ç¡®è®¤å¯†ç 
          <i>å†æ¬¡è¾“å…¥</i>
        </label>
        <input type="password" id="confirmPasswordInput" class="input-field" placeholder="ç¡®è®¤æ–°å¯†ç " maxlength="6" inputmode="numeric" pattern="\d*">
        <div class="field-foot">
          <span class="error-message" id="confirmPasswordError">ä¸¤æ¬¡å¯†ç ä¸ä¸€è‡´</span>
        </div>
      </div>
    </div>

    <!-- åŠ¨æ€æŒ‰é’®åŒºåŸŸï¼šæ ¹æ®çŠ¶æ€æ˜¾ç¤ºä¸åŒæŒ‰é’® -->
    <div class="button-row" id="buttonRow">
      <!-- åˆå§‹çŠ¶æ€ï¼šéªŒè¯è´¦å· + å–æ¶ˆï¼ˆæ¸…ç©ºï¼‰ -->
      <button class="btn btn-verify" id="verifyBtn">éªŒè¯è´¦å·</button>
      <button class="btn btn-cancel" id="cancelBtn">æ¸… ç©º</button>
    </div>

    <!-- åº•éƒ¨é“¾æ¥ï¼šè¿”å›ç™»å½• -->
    <div class="footer-links">
      <a href="#" id="backToLogin">ğŸ”™ è¿”å›ç™»å½•</a>
    </div>
  </div>

  <script>
    (function() {
      'use strict';

      // ---------- DOM å…ƒç´  ----------
      const accountInput = document.getElementById('accountInput');
      const accountErrorSpan = document.getElementById('accountError');
      
      const newPasswordSection = document.getElementById('newPasswordSection');
      const newPasswordInput = document.getElementById('newPasswordInput');
      const confirmPasswordInput = document.getElementById('confirmPasswordInput');
      const newPasswordError = document.getElementById('newPasswordError');
      const confirmPasswordError = document.getElementById('confirmPasswordError');
      
      const buttonRow = document.getElementById('buttonRow');
      const verifyBtn = document.getElementById('verifyBtn');
      const cancelBtn = document.getElementById('cancelBtn');
      const backToLoginLink = document.getElementById('backToLogin');

      // çŠ¶æ€æ ‡å¿—ï¼šæ˜¯å¦å·²éªŒè¯é€šè¿‡
      let isVerified = false;

      // ---------- å·¥å…·å‡½æ•° ----------
      function isValidSixDigit(str) {
        return /^\d{6}$/.test(str);
      }

      // æ›´æ–°å•ä¸ªå­—æ®µé”™è¯¯æç¤º (é€šç”¨)
      function updateErrorOnly(inputElement, errorSpan, customEmptyMsg = 'ä¸èƒ½ä¸ºç©º') {
        const val = inputElement.value;
        const rawLen = val.length;

        if (rawLen === 0) {
          errorSpan.textContent = customEmptyMsg;
          errorSpan.classList.add('show');
        } else if (rawLen < 6) {
          errorSpan.textContent = `å¿…é¡»ä¸º6ä½æ•°å­— (å½“å‰${rawLen}ä½)`;
          errorSpan.classList.add('show');
        } else if (rawLen === 6 && !isValidSixDigit(val)) {
          errorSpan.textContent = 'åªèƒ½åŒ…å«æ•°å­—0-9';
          errorSpan.classList.add('show');
        } else if (rawLen === 6 && isValidSixDigit(val)) {
          errorSpan.classList.remove('show');
        } else {
          errorSpan.classList.remove('show');
        }
      }

      // éªŒè¯å•ä¸ªå­—æ®µ (å¸¦æŠ–åŠ¨)
      function validateField(inputElement, errorSpan, customEmptyMsg = 'ä¸èƒ½ä¸ºç©º') {
        const val = inputElement.value;
        let isValid = true;

        if (!isValidSixDigit(val)) {
          isValid = false;
          inputElement.classList.add('error-shake');
          if (val.length !== 6) {
            errorSpan.textContent = `å¿…é¡»ä¸º6ä½æ•°å­— (å½“å‰${val.length}ä½)`;
          } else if (!/^\d+$/.test(val)) {
            errorSpan.textContent = 'åªèƒ½åŒ…å«æ•°å­—0-9';
          } else {
            errorSpan.textContent = 'æ— æ•ˆçš„6ä½æ•°å­—';
          }
          errorSpan.classList.add('show');
          setTimeout(() => {
            inputElement.classList.remove('error-shake');
          }, 300);
        } else {
          errorSpan.classList.remove('show');
          inputElement.classList.remove('error-shake');
        }
        return isValid;
      }

      // æ¸…ç©ºæ‰€æœ‰è¾“å…¥å¹¶é‡ç½®åˆ°åˆå§‹çŠ¶æ€
      function resetToInitial() {
        // æ¸…ç©ºè´¦å·
        accountInput.value = '';
        accountErrorSpan.classList.remove('show');
        accountInput.classList.remove('error-shake');
        
        // éšè—æ–°å¯†ç åŒºåŸŸ
        newPasswordSection.style.display = 'none';
        // æ¸…ç©ºæ–°å¯†ç ç›¸å…³å­—æ®µå’Œé”™è¯¯
        if (newPasswordInput) newPasswordInput.value = '';
        if (confirmPasswordInput) confirmPasswordInput.value = '';
        if (newPasswordError) newPasswordError.classList.remove('show');
        if (confirmPasswordError) confirmPasswordError.classList.remove('show');
        
        // é‡ç½®æŒ‰é’®åŒºåŸŸä¸º éªŒè¯+å–æ¶ˆ
        buttonRow.innerHTML = `
          <button class="btn btn-verify" id="verifyBtn">éªŒè¯è´¦å·</button>
          <button class="btn btn-cancel" id="cancelBtn">æ¸… ç©º</button>
        `;
        // é‡æ–°ç»‘å®šäº‹ä»¶
        document.getElementById('verifyBtn').addEventListener('click', verifyHandler);
        document.getElementById('cancelBtn').addEventListener('click', cancelHandler);
        
        isVerified = false;
      }

      // åˆ‡æ¢åˆ°æ–°å¯†ç è®¾ç½®ç•Œé¢ (éªŒè¯é€šè¿‡å)
      function switchToResetPassword() {
        newPasswordSection.style.display = 'block';
        
        // æ›´æ¢æŒ‰é’®: é‡ç½®å¯†ç  + å–æ¶ˆ (å–æ¶ˆåŠŸèƒ½æ”¹ä¸ºè¿”å›åˆå§‹)
        buttonRow.innerHTML = `
          <button class="btn btn-reset" id="resetBtn">é‡ç½®å¯†ç </button>
          <button class="btn btn-cancel" id="cancelToInitialBtn">å– æ¶ˆ</button>
        `;
        
        document.getElementById('resetBtn').addEventListener('click', resetPasswordHandler);
        document.getElementById('cancelToInitialBtn').addEventListener('click', function() {
          resetToInitial();
        });
        
        isVerified = true;
      }

      // ---------- äº‹ä»¶å¤„ç†å‡½æ•° ----------
      function verifyHandler(e) {
        e.preventDefault();
        
        // å…ˆæ›´æ–°é”™è¯¯æç¤º
        updateErrorOnly(accountInput, accountErrorSpan);
        const isAccountValid = validateField(accountInput, accountErrorSpan);
        
        if (isAccountValid) {
          // æ¨¡æ‹Ÿåç«¯éªŒè¯ï¼šè¿™é‡Œå‡è®¾ä»»ä½•6ä½æ•°å­—è´¦å·éƒ½æ˜¯å­˜åœ¨çš„ï¼ˆæ¼”ç¤ºç”¨ï¼‰
          // å®é™…å¼€å‘å¯åœ¨æ­¤è°ƒç”¨API
          alert(`âœ… è´¦å·éªŒè¯é€šè¿‡ï¼\nè´¦å· ${accountInput.value} å­˜åœ¨ï¼Œè¯·è®¾ç½®æ–°å¯†ç ã€‚`);
          switchToResetPassword();
        } else {
          alert('âŒ è¯·è¾“å…¥æœ‰æ•ˆçš„6ä½æ•°å­—è´¦å·');
        }
      }

      function cancelHandler(e) {
        e.preventDefault();
        resetToInitial();
      }

      function resetPasswordHandler(e) {
        e.preventDefault();
        
        // éªŒè¯æ–°å¯†ç å’Œç¡®è®¤å¯†ç 
        updateErrorOnly(newPasswordInput, newPasswordError, 'è¯·è¾“å…¥æ–°å¯†ç ');
        updateErrorOnly(confirmPasswordInput, confirmPasswordError, 'è¯·ç¡®è®¤å¯†ç ');
        
        const isNewPwdValid = validateField(newPasswordInput, newPasswordError, 'è¯·è¾“å…¥æ–°å¯†ç ');
        const isConfirmPwdValid = validateField(confirmPasswordInput, confirmPasswordError, 'è¯·ç¡®è®¤å¯†ç ');
        
        // è‡ªå®šä¹‰ç¡®è®¤å¯†ç ä¸€è‡´æ€§éªŒè¯
        const newPwd = newPasswordInput.value;
        const confirmPwd = confirmPasswordInput.value;
        
        if (isNewPwdValid && isConfirmPwdValid) {
          if (newPwd !== confirmPwd) {
            // æ˜¾ç¤ºä¸ä¸€è‡´é”™è¯¯
            confirmPasswordError.textContent = 'ä¸¤æ¬¡å¯†ç ä¸ä¸€è‡´';
            confirmPasswordError.classList.add('show');
            confirmPasswordInput.classList.add('error-shake');
            setTimeout(() => {
              confirmPasswordInput.classList.remove('error-shake');
            }, 300);
            alert('âŒ ä¸¤æ¬¡è¾“å…¥çš„å¯†ç ä¸ä¸€è‡´');
            return;
          }
          
          // æ‰€æœ‰éªŒè¯é€šè¿‡
          alert(`ğŸ‰ å¯†ç é‡ç½®æˆåŠŸï¼\nè´¦å· ${accountInput.value} çš„æ–°å¯†ç å·²ç”Ÿæ•ˆï¼ˆæ¼”ç¤ºæ¨¡å¼ï¼‰`);
          // é‡ç½®æ‰€æœ‰çŠ¶æ€ï¼Œè¿”å›ç™»å½•å‰ç•Œé¢
          resetToInitial();
          // å¯åœ¨æ­¤è·³è½¬ç™»å½•é¡µ
        } else {
          alert('âŒ è¯·æ­£ç¡®å¡«å†™6ä½æ•°å­—å¯†ç ');
        }
      }

      // ---------- å®æ—¶è¾“å…¥è¿‡æ»¤ ----------
      accountInput.addEventListener('input', function(e) {
        this.value = this.value.replace(/\D/g, '').slice(0, 6);
        updateErrorOnly(accountInput, accountErrorSpan);
      });

      // æ–°å¯†ç åŒºåŸŸçš„å®æ—¶è¿‡æ»¤ (åŠ¨æ€å…ƒç´ ï¼Œä½¿ç”¨äº‹ä»¶å§”æ‰˜æˆ–è€…ç›´æ¥ç»‘å®šï¼Œä½†å…ƒç´ å·²å­˜åœ¨å¯ç”¨)
      if (newPasswordInput) {
        newPasswordInput.addEventListener('input', function(e) {
          this.value = this.value.replace(/\D/g, '').slice(0, 6);
          updateErrorOnly(newPasswordInput, newPasswordError, 'è¯·è¾“å…¥æ–°å¯†ç ');
        });
      }
      
      if (confirmPasswordInput) {
        confirmPasswordInput.addEventListener('input', function(e) {
          this.value = this.value.replace(/\D/g, '').slice(0, 6);
          // ç¡®è®¤å¯†ç å•ç‹¬é”™è¯¯å¤„ç† (å¯å®æ—¶æ£€æŸ¥ä¸€è‡´æ€§ï¼Œä½†ä¸ºäº†ç®€æ´åªæ›´æ–°æ ¼å¼)
          const val = this.value;
          if (val.length === 6 && isValidSixDigit(val)) {
            // å¦‚æœæ ¼å¼æ­£ç¡®ï¼Œæš‚æ—¶ç§»é™¤é”™è¯¯ï¼Œä½†ä¸€è‡´æ€§éœ€åœ¨æäº¤æ—¶åˆ¤æ–­
            if (newPasswordInput.value === val) {
              confirmPasswordError.classList.remove('show');
            } else {
              // å¦‚æœå¯†ç ä¸ä¸€è‡´ä¸”ä¸¤è€…éƒ½æ»¡6ä½ï¼Œå¯å®æ—¶æç¤º
              if (newPasswordInput.value.length === 6 && val.length === 6) {
                confirmPasswordError.textContent = 'ä¸¤æ¬¡å¯†ç ä¸ä¸€è‡´';
                confirmPasswordError.classList.add('show');
              } else {
                confirmPasswordError.classList.remove('show');
              }
            }
          } else {
            updateErrorOnly(confirmPasswordInput, confirmPasswordError, 'è¯·ç¡®è®¤å¯†ç ');
          }
        });
      }

      // å¤±å»ç„¦ç‚¹æ›´æ–°
      accountInput.addEventListener('blur', function() {
        updateErrorOnly(accountInput, accountErrorSpan);
      });

      // è¿”å›ç™»å½•é“¾æ¥
      backToLoginLink.addEventListener('click', function(e) {
        e.preventDefault();
        alert('â†©ï¸ è¿”å›ç™»å½•é¡µé¢ (å¯æ›¿æ¢ä¸ºå®é™…é“¾æ¥)');
      });

      // åˆå§‹åŒ–
      resetToInitial();
    })();
  </script>
</body>
</html>